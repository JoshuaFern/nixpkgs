diff --git a/client/display.c b/client/display.c
index 0faa084..ed4663f 100644
--- a/client/display.c
+++ b/client/display.c
@@ -30,6 +30,7 @@
 
 #include <readline/history.h>
 #include <readline/readline.h>
+#include <assert.h>
 #include <ell/ell.h>
 
 #include "agent.h"
@@ -372,7 +373,9 @@ static void display_completion_matches(char **matches, int num_matches,
 	l_free(prompt);
 
 	for (index = 1, line_used = 0; matches[index]; index++) {
-		if ((line_used + max_length) > LINE_LEN) {
+		assert(index <= num_matches);
+		assert(strlen(matches[index]) <= max_length);
+		if ((line_used + max_length + 1 + 1 /* :( */) >= LINE_LEN) {
 			strcpy(&line[line_used], "\n");
 
 			display_text(line);
@@ -380,10 +383,11 @@ static void display_completion_matches(char **matches, int num_matches,
 			line_used = 0;
 		}
 
+		// XXX: entry > LINE_LEN, if possible, will overflow 'line'! :(
 		entry = l_strdup_printf("%-*s ", max_length, matches[index]);
+		assert(strlen(entry) == max_length + 1);
 		strcpy(&line[line_used], entry);
 		l_free(entry);
-
 		line_used += max_length + 1;
 	}
 
