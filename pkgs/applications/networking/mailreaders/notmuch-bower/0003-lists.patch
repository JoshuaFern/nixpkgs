From 2d6b1690f866caf674c8970ee11af5684ae6dbc0 Mon Sep 17 00:00:00 2001
From: Will Dietz <w@wdtz.org>
Date: Mon, 22 Oct 2018 00:52:30 -0500
Subject: [PATCH 3/3] lists

---
 src/index_view.m   | 3 ++-
 src/tags.m         | 5 ++++-
 src/thread_pager.m | 3 ++-
 3 files changed, 8 insertions(+), 3 deletions(-)

diff --git a/src/index_view.m b/src/index_view.m
index 88330b0..2a1977e 100644
--- a/src/index_view.m
+++ b/src/index_view.m
@@ -1852,7 +1852,8 @@ draw_index_line(IAttrs, Panel, Line, _LineNr, IsCursor, !IO) :-
 draw_display_tag(Panel, Tag, !IO) :-
     ( display_tag(Tag) ->
         Tag = tag(TagName),
-        draw2(Panel, " ", TagName, !IO)
+        TagName2 = string.remove_prefix_if_present("lists/", TagName),
+        draw2(Panel, " ", TagName2, !IO)
     ;
         true
     ).
diff --git a/src/tags.m b/src/tags.m
index 8000349..042e0db 100644
--- a/src/tags.m
+++ b/src/tags.m
@@ -95,6 +95,7 @@ nondisplay_tag(tag("signed")).
 nondisplay_tag(tag("unread")).
 nondisplay_tag(tag("important")).
 nondisplay_tag(tag("inbox")).
+nondisplay_tag(tag("lists")).
 nondisplay_tag(tag("old/Research")).
 nondisplay_tag(tag("llvm dev lists/llvm-commits")).
 nondisplay_tag(tag("llvm dev lists/clang-commits")).
@@ -130,7 +131,9 @@ get_standard_tags_2(Tag, !StdTags, !DisplayTagsWidth) :-
     ; display_tag(Tag) ->
         Tag = tag(TagName),
         % Add one for separator.
-        !:DisplayTagsWidth = !.DisplayTagsWidth + string_wcwidth(TagName) + 1
+        !:DisplayTagsWidth = !.DisplayTagsWidth +
+            string_wcwidth(string.remove_prefix_if_present("lists/",TagName)) +
+            1
     ;
         true
     ).
diff --git a/src/thread_pager.m b/src/thread_pager.m
index d27a47a..2e8ad14 100644
--- a/src/thread_pager.m
+++ b/src/thread_pager.m
@@ -2958,7 +2958,8 @@ draw_thread_line(TAttrs, Panel, Line, _LineNr, IsCursor, !IO) :-
 draw_display_tag(Panel, Tag, !IO) :-
     ( display_tag(Tag) ->
         Tag = tag(TagName),
-        draw2(Panel, " ", TagName, !IO)
+        TagName2 = string.remove_prefix_if_present("lists/", TagName),
+        draw2(Panel, " ", TagName2, !IO)
     ;
         true
     ).
-- 
2.19.1

