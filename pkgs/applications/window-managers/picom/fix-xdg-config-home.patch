From a9e9675db946951004d22d48d880860c20252718 Mon Sep 17 00:00:00 2001
From: Will Dietz <w@wdtz.org>
Date: Thu, 5 Mar 2020 06:38:12 -0600
Subject: [PATCH] xdg_config_home: fix issue free'ing result, return
 heap-allocated string

---
 src/config_libconfig.c | 11 +++++------
 1 file changed, 5 insertions(+), 6 deletions(-)

diff --git a/src/config_libconfig.c b/src/config_libconfig.c
index c2fb243..3aaa451 100644
--- a/src/config_libconfig.c
+++ b/src/config_libconfig.c
@@ -40,14 +40,13 @@ const char *xdg_config_home(void) {
 	char *xdgh = getenv("XDG_CONFIG_HOME");
 	char *home = getenv("HOME");
 
-	if (!xdgh) {
-		if (!home) return NULL;
+	if (xdgh) return strdup(xdgh);
+	if (!home) return NULL;
 
-		xdgh = cvalloc(strlen(home) + 8 + 1);
+	xdgh = cvalloc(strlen(home) + 8 + 1);
 
-		strcpy(xdgh, home);
-		strcat(xdgh, "/.config");
-	}
+	strcpy(xdgh, home);
+	strcat(xdgh, "/.config");
 
 	return xdgh;
 }
-- 
2.25.1-460

