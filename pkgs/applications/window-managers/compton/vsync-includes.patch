From df90d946d004c3747b0600733625bc66f50101d9 Mon Sep 17 00:00:00 2001
From: Will Dietz <w@wdtz.org>
Date: Mon, 17 Dec 2018 14:55:32 -0600
Subject: [PATCH] vsync: add libdrm includes needed for migrated code, copied
 for now

---
 src/common.h  | 11 +++++++++++
 src/compton.h | 10 ----------
 src/vsync.c   |  5 +++++
 3 files changed, 16 insertions(+), 10 deletions(-)

diff --git a/src/common.h b/src/common.h
index b9a8b2b..e01eb9b 100644
--- a/src/common.h
+++ b/src/common.h
@@ -116,6 +116,17 @@
 
 #endif
 
+#ifdef CONFIG_VSYNC_DRM
+#include <fcntl.h>
+// We references some definitions in drm.h, which could also be found in
+// /usr/src/linux/include/drm/drm.h, but that path is probably even less
+// reliable than libdrm
+#include <drm.h>
+#include <sys/ioctl.h>
+#include <errno.h>
+#endif
+
+
 // === Macros ===
 
 #define MSTR_(s)        #s
diff --git a/src/compton.h b/src/compton.h
index 1f7ace7..de35d32 100644
--- a/src/compton.h
+++ b/src/compton.h
@@ -14,16 +14,6 @@
 #include <locale.h>
 #include <signal.h>
 
-#ifdef CONFIG_VSYNC_DRM
-#include <fcntl.h>
-// We references some definitions in drm.h, which could also be found in
-// /usr/src/linux/include/drm/drm.h, but that path is probably even less
-// reliable than libdrm
-#include <drm.h>
-#include <sys/ioctl.h>
-#include <errno.h>
-#endif
-
 #include <X11/Xutil.h>
 #include <pixman.h>
 #ifdef CONFIG_OPENGL
diff --git a/src/vsync.c b/src/vsync.c
index 909ad2d..893eda3 100644
--- a/src/vsync.c
+++ b/src/vsync.c
@@ -12,6 +12,11 @@
 
 #include "vsync.h"
 
+#ifdef CONFIG_VSYNC_DRM
+static int
+vsync_drm_wait(session_t *ps);
+#endif
+
 /**
  * Initialize DRM VSync.
  *
-- 
2.20.1

